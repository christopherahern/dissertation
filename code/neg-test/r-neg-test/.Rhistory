not.se = sqrt(not.p*(1-not.p)/total))
neg.years = neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
#test = c('n.bin', 'prev.neg', 'total')
#neg.years = melt(neg.years, id=test)
neg.years.melt = melt(neg.years %>% select(n.bin, prev.neg, ne.p, not.p, ne.not.p), id=c('n.bin', 'prev.neg'))
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
# Bar plots faceted  by previous form and time bin
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
ggplot(neg.years.melt, aes(x=prev.neg, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~ n.bin, nrow=1)
neg.years
neg.years %>% group_by(n.bin)
melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin', 'prev.neg'))
melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin'))
test = melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin'))
ggplot(test, aes(x=prev.neg, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~ n.bin, nrow=1)
ggplot(test, aes(x=nbin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge")
ggplot(test, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge")
neg.years$variable = factor(neg.years$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years = neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years$variable = factor(neg.years$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years
test = melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin'))
ggplot(test, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge")
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE)
unique(neg.data$year)
unique(neg.data.full$year)
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
unique(neg.data.full$year)
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE)
number = 5
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE)
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/5)), include.lowest=TRUE)
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/5))), include.lowest=TRUE)
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/5), include.lowest=TRUE))
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/5), include.lowest=TRUE)))
quantile(neg.data$year, probs=seq(0,1,1/5)
quantile(neg.data$year, probs=seq(0,1,1/5))
quantile(neg.data$year, probs=seq(0,1,1/5), include.lowest=TRUE)
cut(neg.data, as.vector(quantile(neg.data$year, probs=seq(0,1,1/5))), include.lowest=TRUE)
cut(neg.data$year, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE)
unique(cut(neg.data$year, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE))
unique(cut(neg.data$year, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE))[1]
unique(cut(neg.data$year, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE))[1][1]
unique(cut(neg.data$year, as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))), include.lowest=TRUE))[1][[1]
]
as.vector(quantile(neg.data$year, probs=seq(0,1,1/number)))
seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/number)
as.vector(quantile(neg.data$year, probs=seq(0,1,1/number)))
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
ggplot(neg.years.melt, aes(x=prev.neg, y=value, color=variable)) +
#geom_bar(stat="identity", position="dodge", aes(fill=variable,alpha=.2)) +
geom_line(position="identity",aes(group=variable), size=4) +
facet_wrap(~ n.bin, nrow=1)
ggplot(neg.quants, aes(x=prev.neg, y=value, color=variable)) +
#geom_bar(stat="identity", position="dodge", aes(fill=variable,alpha=.2)) +
geom_line(position="identity",aes(group=variable), size=4) +
facet_wrap(~ q.bin, nrow=1)
for (i in c(1:8)){
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/number))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/number))))
}
for (i in c(1:8)){
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/i))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/i))))
}
for (i in c(1:8)){
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/(i+1)))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/(i+1)))))
}
for (i in c(2:8)){
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/(i+1)))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/(i+1)))))
}
for (i in c(2:8)){
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/i+1))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/i))))
}
for (i in c(2:8)){
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/i))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/i))))
}
for (i in c(2:8)){
print(i)
print(seq(min(neg.data$year), max(neg.data$year), (max(neg.data$year)-min(neg.data$year))/i))
print(as.vector(quantile(neg.data$year, probs=seq(0,1,1/i))))
}
ggplot(neg.quants, aes(x=prev.neg, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~ q.bin, nrow=1)
neg.data = neg.data.full %>%
mutate(prev.neg = lag(neg.type)) %>%
filter(! author %in% excluded.texts & exclude != "X") %>%
filter(!is.na(neg.type) & !is.na(prev.neg)) %>%
mutate(n.bin = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE),
n.bin.label = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE, label=FALSE)
q.bin = cut(year, as.vector(quantile(.$year, probs=seq(0,1,1/number))), include.lowest=TRUE))
neg.data = neg.data.full %>%
mutate(prev.neg = lag(neg.type)) %>%
filter(! author %in% excluded.texts & exclude != "X") %>%
filter(!is.na(neg.type) & !is.na(prev.neg)) %>%
mutate(n.bin = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE),
n.bin.label = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE, label=FALSE),
q.bin = cut(year, as.vector(quantile(.$year, probs=seq(0,1,1/number))), include.lowest=TRUE))
neg.data
neg.data %>% filter(n.bin.label == 1)
neg.data %>% filter(n.bin.label == 1) %>% group_by(neg.type)
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>%
summarize(count=n())
neg.test = neg.data %>% filter(n.bin.label == 1)
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type, prev.neg) %>%
summarize(count=n())
neg.test
boxplot(neg.test$year)
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type, prev.neg) %>%
summarize(count=n())
neg.years = neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin')
test = melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin'))
ggplot(test, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge")
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
neg.years.melt = melt(neg.years %>% select(n.bin, prev.neg, ne.p, not.p, ne.not.p), id=c('n.bin', 'prev.neg'))
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
ggplot(neg.years.melt, aes(x=prev.neg, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~ n.bin, nrow=1)
neg.years = neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin')
melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin'))
neg.years.melt = melt(neg.years %>% select(n.bin, ne.p, not.p, ne.not.p), id=c('n.bin'))
neg.years.melt
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
neg.years.melt
neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years.melt = melt(neg.years %>% select(n.bin, prev.neg, ne.p, not.p, ne.not.p), id=c('n.bin'))
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
neg.years =   neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years.melt = melt(neg.years %>% select(n.bin, prev.neg, ne.p, not.p, ne.not.p), id=c('n.bin'))
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
neg.years.melt
neg.years.melt = melt(neg.years %>% select(n.bin, prev.neg, ne.p, not.p, ne.not.p), id=c('n.bin', 'prev.neg'))
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
neg.years.melt = melt(neg.years %>% select(n.bin, prev.neg, ne.p, not.p, ne.not.p), id=c('n.bin', 'prev.neg'))
neg.years.melt$variable = factor(neg.years.melt$variable, levels = c("ne.p", "ne.not.p", "not.p"))
neg.years.melt$prev.neg = factor(neg.years.melt$prev.neg, levels = c("ne", "both", "not"))
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
dev.off()
ggplot(neg.years.melt, aes(x=n.bin, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~prev.neg)
ggplot(neg.years.melt, aes(x=prev.neg, y=value, fill=variable)) +
geom_bar(stat="identity", position="dodge") + facet_wrap(~ n.bin, nrow=1)
neg.test = neg.data %>% filter(n.bin.label == 1)
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type, prev.neg) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type, prev.neg) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 2) %>%
group_by(neg.type, prev.neg) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(prev.neg, neg.type) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 2) %>%
group_by(neg.type, prev.neg) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(prev.neg, neg.type) %>%
summarize(count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>%
summarize(prop = n(), count=n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% mutate(count = n()) %>%
summarize(prop = n()/sum(count))
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% mutate(count = n()) %>%
summarize(prop = n()/sum(n()))
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% mutate(count = n()) %>%
summarize(prop = n()/sum(count))
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% mutate(count = n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% summarize(count = n())
neg.data %>% filter(n.bin.label == 1) %>%
group_by(prev.neg, neg.type) %>%
summarize(count=n())
neg.test = neg.data %>% filter(n.bin.label == 1)
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% summarize(count = n())
neg.years =   neg.data %>% group_by(n.bin, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years
neg.years =   neg.data %>% group_by(n.bin.label, prev.neg) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total))
neg.years
neg.years %>% filter(n.bin.labe == 1)
neg.years %>% filter(n.bin.label == 1)
neg.data %>% group_by(n.bin.label) %>%
summarize(total=n(),
ne.p=sum(neg.type=="ne")/total,
ne.se = sqrt(ne.p*(1-ne.p)/total),
ne.not.p=sum(neg.type=="both")/total,
ne.not.se = sqrt(ne.not.p*(1-ne.not.p)/total),
not.p=sum(neg.type=="not")/total,
not.se = sqrt(not.p*(1-not.p)/total)) %>%
filter(n.bin.label == 1)
neg.years %>% filter(n.bin.label == 1)
.82*.8
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(xtable)
source("neg-data.R")
source("binning.R")
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
excluded.texts = c("CMBOETH", "CMORM", "CMNTEST","CMOTEST")
number = 5
neg.data = neg.data.full %>%
mutate(prev.neg = lag(neg.type)) %>%
filter(! author %in% excluded.texts & exclude != "X") %>%
filter(!is.na(neg.type) & !is.na(prev.neg)) %>%
mutate(n.bin = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE),
n.bin.label = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE, label=FALSE),
q.bin = cut(year, as.vector(quantile(.$year, probs=seq(0,1,1/number))), include.lowest=TRUE))
neg.test = neg.data %>% filter(n.bin.label == 1)
neg.data %>% filter(n.bin.label == 1) %>%
group_by(neg.type) %>% summarize(count = n())
neg.data = neg.data.full %>%
mutate(prev.neg = lag(neg.type)) %>%
filter(! author %in% excluded.texts & exclude != "X") %>%
filter(!is.na(neg.type) & !is.na(prev.neg)) %>%
mutate(n.bin = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE),
n.bin.label = cut(year, seq(min(.$year), max(year), (max(year)-min(year))/number), include.lowest=TRUE, label=FALSE),
q.bin = cut(year, as.vector(quantile(.$year, probs=seq(0,1,1/number))), include.lowest=TRUE))
neg.data
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
neg.data.full %>% filter(author == "CMBOETH")
neg.data.full %>% filter(author == "CMBOETH")
neg.data.full %>% filter(author == "CMORM")
neg.data.full %>% filter(author == "CMOTEST")
neg.data.full %>% filter(author == "CMNTEST")
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(xtable)
source("neg-data.R")
source("binning.R")
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
excluded.texts = c("CMBOETH", "CMORM", "CMNTEST","CMOTEST")
neg.data.full = neg.data.full %>% filter(! author %in% excluded.texts & exclude != "X")
neg.data.full
neg.data.full
neg.data.full$neg.type
neg.plot.auth = neg.data.full %>% group_by(year) %>% summarize(total=n(), ne=sum(neg.type=="ne", na.rm=TRUE)/total,not=sum(neg.type=="not", na.rm=TRUE)/total,ne.not=sum(neg.type=="both", na.rm=TRUE)/total)
neg.plot.auth = melt(test, id=c("year", "total"))
neg.plot.auth
neg.plot.auth = melt(test, id=c("year", "total"))
neg.plot.auth
neg.plot.auth = melt(neg.plot.auth, id=c("year", "total"))
neg.plot.auth
ggplot(aes(x = year, y = value, color = variable), data = neg.plot.auth) +
geom_point(aes(size = total), alpha = 0.5, position = position_jitter()) +
geom_smooth(aes(weight = total),method="loess", span=.5, se = FALSE, size=4) + # span=.5,
xlab("Year") +   ylab("Proportion forms") +   scale_size_area("N", max_size = 20) +
theme(text = element_text(size=30)) +   theme(legend.position="none") +
coord_cartesian(xlim = c(1090,1540)) +  coord_cartesian(ylim = c(-.1,1.1))
neg.plot.auth
neg.plot.auth %>% filter(year >= 1150 && year <= 1250)
neg.plot.auth %>% filter(year >= 1150 & year <= 1250)
neg.plot.auth %>% filter(year >= 1150 & year <= 1250) %>% summarize()
neg.plot.auth %>% filter(year >= 1150 & year <= 1250) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year == 1150)
neg.plot.auth
neg.plot.auth %>% filter(year == 1150)
neg.plot.auth = neg.data.full %>% group_by(year) %>% summarize(total=n(), ne=sum(neg.type=="ne", na.rm=TRUE)/total,not=sum(neg.type=="not", na.rm=TRUE)/total,ne.not=sum(neg.type=="both", na.rm=TRUE)/total)
neg.plot.auth
neg.plot.auth %>% filter(year == 1250)
neg.plot.auth %>% filter(year == 1350)
neg.plot.auth %>% filter(year >= 1150 & year <= 1250)
neg.plot.auth %>% filter(year >= 1150 & year <= 1250) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year >= 1250 & year <= 1350) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year > 1350 & year <= 1420) %>% summarize(count=sum(total))
neg.plot.auth
neg.plot.auth %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year < 1150) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year >= 1150 & year <= 1250) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year >= 1250 & year <= 1350) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year > 1350 & year <= 1420) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year > 1420) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year < 1150)
neg.plot.auth %>% filter(year == 1200)
neg.plot.auth
neg.plot.auth %>% filter(year >= 1150 & year <= 1250) %>% summarize(count=sum(total))
neg.data.full
neg.data.full
neg.data.full %>% group_by(year)
neg.data.full %>% group_by(year) %>% summarize()
neg.data.full
neg.data.full %>% group_by(year, stages) %>% summarize(count=n())
neg.data.full %>% group_by(year, stages) %>% summarize(count=n()) %>% filter(year >= 1150 & year <= 1250)
neg.data.full %>% filter(year >= 1150 & year <= 1250) %>%
group_by(year, stages) %>% summarize(count=n())
neg.data.full %>% filter(year >= 1150 & year <= 1250) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year <= 1250) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year > 1250 & year <=1350) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year <= 1250) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year > 1250 & year <=1350) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year <= 1250) %>%
group_by(stages) %>% summarize(count=n())
37/52
neg.plot.auth %>% filter(year == 1200)
neg.plot.auth %>% filter(year < 1150)
neg.plot.auth %>% filter(year <= 1200)
ggplot(aes(x = year, y = value, color = variable), data = neg.plot.auth) +
geom_point(aes(size = total), alpha = 0.5, position = position_jitter())
neg.plot.auth = melt(neg.plot.auth, id=c("year", "total"))
ggplot(aes(x = year, y = value, color = variable), data = neg.plot.auth) +
geom_point(aes(size = total), alpha = 0.5, position = position_jitter())
neg.data.full %>% filter(year <= 1150) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year <= 1200) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full
neg.data.full %>% group_by(author) %>% summarize(count=n())
neg.data.full %>% group_by(author, year) %>% summarize(count=n())
group_by(stages) %>% summarize(count=n()) %>% arange(year)
neg.data.full %>% group_by(author, year) %>% summarize(count=n()) %>% arrange(year)
neg.data.full %>% group_by(author, year) %>% arrange(year)
neg.data.full %>% group_by(author, year) %>% arrange(year) %>% summarize(count=n())
neg.data.full %>% arrange(author, year) %>% summarize(count=n())
neg.data.full %>% arrange(author, year) %>% group_by(year) %>% summarize(count=n())
neg.data.full %>% arrange(year) %>% group_by(year, author) %>% summarize(count=n())
ggplot(aes(x = year, y = value, color = variable), data = neg.plot.auth) +
geom_point(aes(size = total), alpha = 0.5, position = position_jitter()) +
geom_smooth(aes(weight = total),method="loess", span=.5, se = FALSE, size=4) + # span=.5,
xlab("Year") +   ylab("Proportion forms") +   scale_size_area("N", max_size = 20) +
theme(text = element_text(size=30)) +   theme(legend.position="none") +
coord_cartesian(xlim = c(1090,1540)) +  coord_cartesian(ylim = c(-.1,1.1))
neg.plot.auth %>% filter(year <= 1150) %>% summarize(count=sum(total))
neg.plot.auth %>% filter(year <= 1150)
neg.data.full %>% filter(year <= 1150) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year <= 1250) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year <= 1150) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
excluded.texts = c()
neg.data.full = neg.data.full %>% filter(! author %in% excluded.texts & exclude != "X")
neg.data.full
neg.data.full %>% filter(year <= 1150) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year > 1150 & year <=1250) %>%
group_by(stages) %>% summarize(count=n()) %>% arrange(year)
neg.data.full
neg.data.full %>% filter(year > 1150 & year <=1250) %>%
neg.data.full %>% filter(year > 1150 & year <=1250) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full = neg.data.full %>% filter(! author %in% excluded.texts & exclude != "X")
neg.data.full %>% filter(year <= 1150) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year > 1150 & year <=1250) %>%
group_by(stages) %>% summarize(count=n())
neg.data.full %>% filter(year > 1250 & year <=1350) %>%
group_by(stages) %>% summarize(count=n())
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(xtable)
source("neg-data.R")
source("binning.R")
##########################################################################
# Read in data file and filter out texts and contexts
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
excluded.texts = c("CMBOETH", "CMORM", "CMNTEST","CMOTEST")
neg.data.full = neg.data.full %>% filter(! author %in% excluded.texts & exclude != "X")
neg.data.full
neg.data.full %>% select(stages, year, author)
neg.data.full %>% select(stages, year, author) %>% arrange(year)
neg.data.full %>% select(stages, year, author) %>% arrange(year) %>% mutate(value=(stages==2 | stages==3))
select(value, year, author) %>% arrange(year)
neg.data.full %>% mutate(value=as.integer(stages==2 | stages==3))
neg.data.full %>% mutate(value=as.integer(stages==2 | stages==3)) %>% select(value)
neg.data.full %>% mutate(value=as.integer(stages==2 | stages==3)) %>% select(value, year, author) %>% arrange(year)
binary.data = neg.data.full %>% mutate(value=as.integer(stages==2 | stages==3)) %>% select(value, year, author) %>% arrange(year)
ggplot(binary.data, aes(year, value)) + geom_point()
dim(binary.data)
write.csv(binary.data, "curve_data.csv")
write.csv(binary.data, "curve_data.csv", row.names = F)
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(xtable)
source("neg-data.R")
source("binning.R")
neg.data.full = cleanNegData("coding.cod.ooo")
neg.data.full = tbl_df(neg.data.full)
excluded.texts = c("CMBOETH", "CMORM", "CMNTEST","CMOTEST")
neg.data.full = neg.data.full %>% filter(! author %in% excluded.texts & exclude != "X")
neg.data.full
neg.data.full
binary.data = neg.data.full %>% mutate(value=as.integer(stages==2 | stages==3)) %>% select(value, year, author) %>% arrange(year)
write.csv(binary.data, "first_curve_data.csv", row.names = F)
first.curve.data = neg.data.full %>%
mutate(value=as.integer(stages==2 | stages==3)) %>%
select(value, year, author) %>% arrange(year)
write.csv(first.curve.data, "first_curve_data.csv", row.names = F)
# Export (ne and ne...not) vs. not
second.curve.data = neg.data.full %>%
mutate(value=as.integer(stages==3)) %>%
select(value, year, author) %>% arrange(year)
write.csv(second.curve.data, "second_curve_data.csv", row.names = F)
